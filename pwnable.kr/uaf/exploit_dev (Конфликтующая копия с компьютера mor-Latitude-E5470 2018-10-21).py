"""
source ~/peda/peda.py
"""
from pwn import *
# context.terminal = ['tmux', 'splitw', '-v']


proc = process(['gdb', '-q', './uaf'])
# gdb.attach(
#     proc,
#     """
# call close(0)
# call close(1)
# call close(2)
# call open("/dev/pts/1", 2, 0)
# call dup(0)
# call dup(0)
# b * 0x400fb2
# commands
#     x/40x $esp
#     heap all
#     continue
# end
# run
#     """
# )
proc.sendline("""
call close(0)
call close(1)
call close(2)
call open("/dev/pts/1", 2, 0)
call dup(0)
call dup(0)
b * 0x400fb2
commands
    # x/40x $esp
    # heap all
    continue
end
run
""")

proc.sendline("1")
proc.sendline("1")
proc.sendline("1")
proc.sendline("1")
# proc.kill()
# proc.sendline("q")
# print(proc.recvall(2))
# proc.kill()
# proc.interactive()
# proc.sendline("2")
# proc.kill()
